(define nil '())
(define (enumerate-interval x y)
  (if (> x y)
      nil
      (cons x (enumerate-interval (+ x 1) y))))

(define (accumulate op initial sequence)
  (if (null? sequence)
      initial
      (op (car sequence)
          (accumulate op initial (cdr sequence)))))

(define (flatmap proc seq)
  (accumulate append nil (map proc seq)))

(define empty-board nil)

(define (adjoin-position new-row k rest-of-queens)
  (cons new-row rest-of-queens))

(define (safe? k positions)
  (define queenPos (car positions))
  (define (safe-iter top bot remain)
    (cond ((null? remain)
           #t)
          ((or (= (car remain) queenPos)
               (= (car remain) top)
               (= (car remain) bot))
           #f)
          (else
           (safe-iter (- top 1) (+ bot 1) (cdr remain)))))
  (safe-iter (- queenPos 1) (+ queenPos 1) (cdr positions)))

(define (queens board-size)
  (define (queen-cols k)
    (if (= k 0)
        (list empty-board)
        (filter
         (lambda (positions) (safe? k positions))
         (flatmap
          (lambda (rest-of-queens)
            (map (lambda (new-row)
                   (adjoin-position
                    new-row k rest-of-queens))
                 (enumerate-interval 1 board-size)))
          (queen-cols (- k 1))))))
  (queen-cols board-size))

(queens 9)

the output is:
欢迎使用 DrRacket, 版本 6.1.1 [3m].
语言: 大; memory limit: 128 MB.
((5 7 9 4 2 8 6 3 1)
 (6 4 9 5 8 2 7 3 1)
 (4 7 5 2 9 6 8 3 1)
 (7 5 3 9 6 8 2 4 1)
 (7 5 8 2 9 3 6 4 1)
 (7 9 3 5 2 8 6 4 1)
 (6 9 5 2 8 3 7 4 1)
 (3 6 8 5 2 9 7 4 1)
 (6 2 5 7 9 3 8 4 1)
 (7 4 8 3 9 6 2 5 1)
 (8 4 9 3 6 2 7 5 1)
 (6 4 2 8 3 9 7 5 1)
 (3 6 8 2 4 9 7 5 1)
 (4 7 3 8 6 2 9 5 1)
 (7 3 8 2 4 6 9 5 1)
 (5 3 8 4 7 9 2 6 1)
 (8 5 3 9 7 2 4 6 1)
 (5 7 9 3 8 2 4 6 1)
 (5 9 2 4 7 3 8 6 1)
 (3 7 9 4 2 5 8 6 1)
 (4 7 3 8 2 5 9 6 1)
 (8 3 5 2 9 6 4 7 1)
 (6 2 9 5 3 8 4 7 1)
 (5 2 6 9 3 8 4 7 1)
 (4 6 3 9 2 8 5 7 1)
 (5 3 6 9 7 2 4 8 1)
 (7 4 2 9 6 3 5 8 1)
 (6 4 2 7 9 3 5 8 1)
 (8 5 3 6 9 7 1 4 2)
 (5 8 6 9 3 1 7 4 2)
 (7 5 1 6 9 3 8 4 2)
 (5 8 6 1 3 7 9 4 2)
 (8 6 1 3 5 7 9 4 2)
 (9 4 6 8 3 1 7 5 2)
 (8 6 9 3 1 4 7 5 2)
 (8 1 4 6 3 9 7 5 2)
 (6 3 1 8 4 9 7 5 2)
 (4 7 9 6 3 1 8 5 2)
 (4 7 3 6 9 1 8 5 2)
 (7 4 1 3 9 6 8 5 2)
 (4 7 1 3 9 6 8 5 2)
 (7 3 6 8 1 4 9 5 2)
 (5 8 4 9 7 3 1 6 2)
 (9 5 3 8 4 7 1 6 2)
 (8 4 9 3 5 7 1 6 2)
 (3 7 4 8 5 9 1 6 2)
 (5 7 9 4 8 1 3 6 2)
 (7 1 4 8 5 3 9 6 2)
 (3 8 6 4 9 1 5 7 2)
 (9 3 6 4 1 8 5 7 2)
 (5 8 4 1 3 6 9 7 2)
 (5 3 6 9 7 4 1 8 2)
 (7 1 4 6 9 3 5 8 2)
 (5 7 4 1 3 9 6 8 2)
 (6 1 7 4 8 3 5 9 2)
 (7 4 1 8 5 3 6 9 2)
 (5 8 1 4 7 3 6 9 2)
 (8 5 3 1 7 4 6 9 2)
 (6 8 5 2 9 7 4 1 3)
 (7 9 4 2 5 8 6 1 3)
 (5 9 4 6 8 2 7 1 3)
 (9 6 4 2 8 5 7 1 3)
 (6 2 5 7 9 4 8 1 3)
 (4 6 8 2 5 7 9 1 3)
 (6 9 7 4 1 8 2 5 3)
 (9 6 4 7 1 8 2 5 3)
 (9 6 8 2 4 1 7 5 3)
 (4 7 1 6 9 2 8 5 3)
 (6 4 1 7 9 2 8 5 3)
 (6 8 1 7 4 2 9 5 3)
 (8 6 2 7 1 4 9 5 3)
 (9 5 8 4 1 7 2 6 3)
 (7 4 8 1 5 9 2 6 3)
 (9 2 5 7 4 1 8 6 3)
 (7 4 2 9 5 1 8 6 3)
 (1 5 7 9 4 2 8 6 3)
 (4 2 7 9 1 5 8 6 3)
 (1 4 7 9 2 5 8 6 3)
 (5 7 2 4 8 1 9 6 3)
 (8 1 4 7 5 2 9 6 3)
 (5 7 4 1 8 2 9 6 3)
 (7 2 4 1 8 5 9 6 3)
 (8 5 2 4 1 7 9 6 3)
 (5 1 8 4 2 7 9 6 3)
 (5 2 8 1 4 7 9 6 3)
 (6 9 5 1 8 4 2 7 3)
 (4 6 1 9 5 8 2 7 3)
 (9 5 1 4 6 8 2 7 3)
 (6 8 1 5 9 2 4 7 3)
 (8 5 1 6 9 2 4 7 3)
 (2 6 1 9 5 8 4 7 3)
 (4 6 8 2 5 1 9 7 3)
 (1 6 8 5 2 4 9 7 3)
 (6 1 5 7 9 4 2 8 3)
 (6 1 5 2 9 7 4 8 3)
 (4 7 5 2 9 1 6 8 3)
 (2 7 5 1 9 4 6 8 3)
 (7 4 1 5 2 9 6 8 3)
 (6 4 7 1 8 5 2 9 3)
 (5 7 2 6 8 1 4 9 3)
 (5 7 1 6 8 2 4 9 3)
 (7 1 6 2 5 8 4 9 3)
 (8 4 1 7 5 2 6 9 3)
 (8 2 5 7 1 4 6 9 3)
 (5 7 1 4 2 8 6 9 3)
 (7 5 8 2 9 6 3 1 4)
 (6 8 3 7 9 2 5 1 4)
 (9 6 3 7 2 8 5 1 4)
 (7 3 8 6 2 9 5 1 4)
 (5 3 8 6 2 9 7 1 4)
 (5 8 2 7 3 6 9 1 4)
 (7 9 6 3 1 8 5 2 4)
 (6 9 5 8 1 3 7 2 4)
 (3 6 8 5 1 9 7 2 4)
 (6 3 5 8 1 9 7 2 4)
 (6 1 5 7 9 3 8 2 4)
 (7 5 1 8 6 3 9 2 4)
 (7 3 6 8 1 5 9 2 4)
 (9 7 3 8 2 5 1 6 4)
 (3 7 2 8 5 9 1 6 4)
 (5 2 8 3 7 9 1 6 4)
 (7 1 8 5 2 9 3 6 4)
 (1 7 5 8 2 9 3 6 4)
 (5 2 8 1 7 9 3 6 4)
 (3 7 9 1 5 2 8 6 4)
 (3 1 9 7 5 2 8 6 4)
 (9 5 3 1 7 2 8 6 4)
 (9 2 5 7 1 3 8 6 4)
 (7 5 2 8 1 3 9 6 4)
 (2 5 8 6 9 3 1 7 4)
 (3 5 8 2 9 6 1 7 4)
 (6 3 9 2 5 8 1 7 4)
 (2 5 8 1 9 6 3 7 4)
 (1 6 9 5 2 8 3 7 4)
 (5 2 9 1 6 8 3 7 4)
 (1 5 9 2 6 8 3 7 4)
 (6 8 3 1 9 2 5 7 4)
 (3 8 6 1 9 2 5 7 4)
 (1 3 8 6 9 2 5 7 4)
 (6 3 1 8 5 2 9 7 4)
 (8 5 3 1 6 2 9 7 4)
 (2 5 8 1 3 6 9 7 4)
 (9 3 6 2 7 5 1 8 4)
 (7 9 2 6 1 3 5 8 4)
 (9 6 2 7 1 3 5 8 4)
 (8 1 5 7 2 6 3 9 4)
 (7 2 8 6 1 3 5 9 4)
 (6 8 2 7 1 3 5 9 4)
 (7 2 6 3 1 8 5 9 4)
 (7 9 3 8 2 4 6 1 5)
 (3 6 9 7 2 4 8 1 5)
 (9 4 2 7 3 6 8 1 5)
 (8 6 3 9 7 1 4 2 5)
 (8 6 1 3 7 9 4 2 5)
 (8 4 9 7 3 1 6 2 5)
 (1 7 4 8 3 9 6 2 5)
 (8 3 1 4 7 9 6 2 5)
 (3 6 9 7 4 1 8 2 5)
 (4 6 3 9 7 1 8 2 5)
 (6 9 1 4 7 3 8 2 5)
 (4 6 1 9 7 3 8 2 5)
 (4 7 3 8 6 1 9 2 5)
 (8 1 4 7 3 6 9 2 5)
 (8 4 7 9 2 6 1 3 5)
 (9 7 4 2 8 6 1 3 5)
 (9 4 6 8 2 7 1 3 5)
 (7 4 1 8 2 9 6 3 5)
 (8 2 4 1 7 9 6 3 5)
 (1 8 4 2 7 9 6 3 5)
 (2 8 1 4 7 9 6 3 5)
 (7 1 6 9 2 4 8 3 5)
 (1 6 2 9 7 4 8 3 5)
 (7 4 1 9 2 6 8 3 5)
 (4 1 7 9 2 6 8 3 5)
 (7 1 6 8 2 4 9 3 5)
 (7 1 4 2 8 6 9 3 5)
 (3 9 6 8 2 4 1 7 5)
 (3 9 4 2 8 6 1 7 5)
 (6 9 3 1 8 4 2 7 5)
 (3 6 9 1 8 4 2 7 5)
 (9 4 8 1 3 6 2 7 5)
 (3 9 4 1 8 6 2 7 5)
 (8 2 9 6 3 1 4 7 5)
 (9 2 6 8 3 1 4 7 5)
 (2 8 6 9 3 1 4 7 5)
 (3 6 9 2 8 1 4 7 5)
 (1 6 4 2 8 3 9 7 5)
 (1 3 6 8 2 4 9 7 5)
 (2 6 3 1 8 4 9 7 5)
 (2 9 6 3 7 4 1 8 5)
 (6 3 7 2 4 9 1 8 5)
 (6 4 9 1 3 7 2 8 5)
 (4 1 9 6 3 7 2 8 5)
 (6 4 7 1 3 9 2 8 5)
 (7 4 1 3 6 9 2 8 5)
 (2 7 9 6 3 1 4 8 5)
 (9 3 6 2 7 1 4 8 5)
 (2 6 1 3 7 9 4 8 5)
 (2 4 9 7 3 1 6 8 5)
 (2 4 7 1 3 9 6 8 5)
 (1 6 8 3 7 4 2 9 5)
 (7 4 1 3 8 6 2 9 5)
 (3 1 7 2 8 6 4 9 5)
 (3 8 4 7 9 2 5 1 6)
 (4 2 8 3 9 7 5 1 6)
 (3 8 2 4 9 7 5 1 6)
 (2 9 5 3 8 4 7 1 6)
 (1 4 8 3 9 7 5 2 6)
 (3 1 8 4 9 7 5 2 6)
 (1 7 4 8 3 5 9 2 6)
 (8 5 2 9 7 4 1 3 6)
 (2 5 7 9 4 8 1 3 6)
 (4 7 9 2 5 8 1 3 6)
 (9 7 2 4 1 8 5 3 6)
 (7 2 4 9 1 8 5 3 6)
 (4 2 7 9 1 8 5 3 6)
 (9 5 1 8 4 2 7 3 6)
 (5 8 1 9 4 2 7 3 6)
 (9 4 1 5 8 2 7 3 6)
 (8 5 2 9 1 4 7 3 6)
 (4 7 1 8 5 2 9 3 6)
 (7 5 2 8 1 4 9 3 6)
 (8 5 2 4 1 7 9 3 6)
 (3 5 8 2 9 7 1 4 6)
 (1 8 5 3 9 7 2 4 6)
 (1 5 7 9 3 8 2 4 6)
 (7 9 1 3 5 8 2 4 6)
 (7 3 1 9 5 8 2 4 6)
 (5 8 2 9 3 1 7 4 6)
 (9 3 5 2 8 1 7 4 6)
 (3 9 2 5 8 1 7 4 6)
 (5 8 2 7 3 1 9 4 6)
 (7 3 8 2 5 1 9 4 6)
 (1 3 7 2 8 5 9 4 6)
 (3 7 4 2 9 5 1 8 6)
 (3 5 9 2 4 7 1 8 6)
 (4 9 5 3 1 7 2 8 6)
 (4 7 5 2 9 1 3 8 6)
 (7 4 2 5 9 1 3 8 6)
 (4 1 5 2 9 7 3 8 6)
 (3 1 4 7 9 2 5 8 6)
 (5 2 8 3 7 4 1 9 6)
 (5 7 2 4 8 1 3 9 6)
 (3 7 2 4 8 1 5 9 6)
 (1 4 7 3 8 2 5 9 6)
 (4 2 7 3 1 8 5 9 6)
 (3 5 2 8 1 4 7 9 6)
 (5 3 9 6 8 2 4 1 7)
 (2 8 5 3 9 6 4 1 7)
 (2 6 9 3 5 8 4 1 7)
 (3 9 4 8 5 2 6 1 7)
 (5 3 9 4 2 8 6 1 7)
 (5 3 8 4 2 9 6 1 7)
 (4 6 3 9 2 5 8 1 7)
 (3 6 9 5 8 1 4 2 7)
 (8 3 5 9 1 6 4 2 7)
 (6 3 5 8 1 9 4 2 7)
 (4 9 5 8 1 3 6 2 7)
 (4 9 5 3 1 6 8 2 7)
 (9 4 2 5 8 6 1 3 7)
 (6 4 2 8 5 9 1 3 7)
 (8 4 9 1 5 2 6 3 7)
 (2 5 9 4 1 8 6 3 7)
 (4 2 9 5 1 8 6 3 7)
 (1 5 9 6 4 2 8 3 7)
 (6 4 9 1 5 2 8 3 7)
 (4 1 5 9 2 6 8 3 7)
 (5 8 2 9 6 3 1 4 7)
 (5 9 2 6 8 3 1 4 7)
 (2 5 8 6 9 3 1 4 7)
 (3 8 6 9 2 5 1 4 7)
 (5 3 6 9 2 8 1 4 7)
 (2 9 6 3 5 8 1 4 7)
 (5 3 8 6 2 9 1 4 7)
 (9 6 3 1 8 5 2 4 7)
 (6 8 3 1 9 5 2 4 7)
 (9 5 3 1 6 8 2 4 7)
 (3 6 8 1 5 9 2 4 7)
 (1 8 5 3 6 9 2 4 7)
 (3 6 2 9 5 1 8 4 7)
 (1 5 2 6 9 3 8 4 7)
 (2 4 8 3 9 6 1 5 7)
 (4 2 9 3 6 8 1 5 7)
 (4 6 9 3 1 8 2 5 7)
 (6 3 9 4 1 8 2 5 7)
 (1 4 2 8 6 9 3 5 7)
 (1 4 6 3 9 2 8 5 7)
 (4 1 3 6 9 2 8 5 7)
 (6 4 2 8 5 3 1 9 7)
 (4 8 5 3 1 6 2 9 7)
 (1 4 6 8 2 5 3 9 7)
 (5 1 6 4 2 8 3 9 7)
 (3 1 6 8 5 2 4 9 7)
 (4 2 5 8 1 3 6 9 7)
 (2 5 7 9 3 6 4 1 8)
 (5 2 9 6 3 7 4 1 8)
 (3 6 9 2 5 7 4 1 8)
 (4 9 3 6 2 7 5 1 8)
 (5 3 6 9 7 1 4 2 8)
 (3 9 6 4 1 7 5 2 8)
 (5 7 4 1 3 6 9 2 8)
 (5 2 6 9 7 4 1 3 8)
 (1 7 4 6 9 2 5 3 8)
 (7 2 4 6 1 9 5 3 8)
 (3 9 6 2 5 7 1 4 8)
 (5 3 1 6 2 9 7 4 8)
 (7 3 6 2 5 1 9 4 8)
 (2 6 1 7 5 3 9 4 8)
 (1 5 7 2 6 3 9 4 8)
 (5 2 6 1 3 7 9 4 8)
 (3 7 4 2 9 6 1 5 8)
 (6 3 9 7 1 4 2 5 8)
 (3 6 9 7 1 4 2 5 8)
 (6 3 7 4 1 9 2 5 8)
 (6 3 1 4 7 9 2 5 8)
 (4 7 9 2 6 1 3 5 8)
 (2 9 6 4 7 1 3 5 8)
 (2 4 1 7 9 6 3 5 8)
 (1 6 4 2 7 9 3 5 8)
 (2 4 9 7 5 3 1 6 8)
 (5 2 4 9 7 3 1 6 8)
 (3 5 9 4 1 7 2 6 8)
 (5 2 4 1 7 9 3 6 8)
 (2 5 7 4 1 3 9 6 8)
 (4 6 8 3 1 7 5 2 9)
 (3 6 8 1 4 7 5 2 9)
 (5 7 4 1 3 8 6 2 9)
 (6 4 7 1 8 2 5 3 9)
 (5 8 4 1 7 2 6 3 9)
 (4 8 1 5 7 2 6 3 9)
 (2 7 5 8 1 4 6 3 9)
 (6 3 7 2 8 5 1 4 9)
 (7 3 1 6 8 5 2 4 9)
 (5 1 8 6 3 7 2 4 9)
 (5 3 1 7 2 8 6 4 9)
 (2 5 7 1 3 8 6 4 9)
 (5 7 2 6 3 1 8 4 9)
 (3 7 2 8 6 4 1 5 9)
 (6 3 7 2 4 8 1 5 9)
 (7 4 2 8 6 1 3 5 9)
 (4 6 8 2 7 1 3 5 9)
 (2 6 1 7 4 8 3 5 9)
 (3 6 2 7 1 4 8 5 9)
 (4 8 5 3 1 7 2 6 9)
 (7 4 2 5 8 1 3 6 9)
 (4 1 5 8 2 7 3 6 9)
 (3 1 7 5 8 2 4 6 9)
 (3 5 2 8 1 7 4 6 9)
 (3 5 7 1 4 2 8 6 9)
 (6 3 5 8 1 4 2 7 9)
 (4 6 1 5 2 8 3 7 9)
 (5 3 1 6 8 2 4 7 9))
